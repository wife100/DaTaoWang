(function e(n,t,r){function o(l,s){if(!t[l]){if(!n[l]){var a="function"==typeof require&&require;if(!s&&a)return a(l,!0);if(i)return i(l,!0);var u=new Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var c=t[l]={exports:{}};n[l][0].call(c.exports,function(e){return o(n[l][1][e]||e)},c,c.exports,e,n,t,r)}return t[l].exports}for(var i="function"==typeof require&&require,l=0;l<r.length;l++)o(r[l]);return o})({1:[function(e,n){var t,r=e("./lib/build-log"),o=e("./lib/epsilon"),i=e("./lib/intersecter"),l=e("./lib/segment-chainer"),s=e("./lib/segment-selector"),a=e("./lib/geojson"),u=!1,c=o();function f(e,n,r){var o=t.segments(e),i=t.segments(n),l=r(t.combine(o,i));return t.polygon(l)}t={buildLog:function(e){return!0===e?u=r():!1===e&&(u=!1),!1!==u&&u.list},epsilon:function(e){return c.epsilon(e)},segments:function(e){var n=i(!0,c,u);return e.regions.forEach(n.addRegion),{segments:n.calculate(e.inverted),inverted:e.inverted}},combine:function(e,n){return{combined:i(!1,c,u).calculate(e.segments,e.inverted,n.segments,n.inverted),inverted1:e.inverted,inverted2:n.inverted}},selectUnion:function(e){return{segments:s.union(e.combined,u),inverted:e.inverted1||e.inverted2}},selectIntersect:function(e){return{segments:s.intersect(e.combined,u),inverted:e.inverted1&&e.inverted2}},selectDifference:function(e){return{segments:s.difference(e.combined,u),inverted:e.inverted1&&!e.inverted2}},selectDifferenceRev:function(e){return{segments:s.differenceRev(e.combined,u),inverted:!e.inverted1&&e.inverted2}},selectXor:function(e){return{segments:s.xor(e.combined,u),inverted:e.inverted1!==e.inverted2}},polygon:function(e){return{regions:l(e.segments,c,u),inverted:e.inverted}},polygonFromGeoJSON:function(e){return a.toPolygon(t,e)},polygonToGeoJSON:function(e){return a.fromPolygon(t,c,e)},union:function(e,n){return f(e,n,t.selectUnion)},intersect:function(e,n){return f(e,n,t.selectIntersect)},difference:function(e,n){return f(e,n,t.selectDifference)},differenceRev:function(e,n){return f(e,n,t.selectDifferenceRev)},xor:function(e,n){return f(e,n,t.selectXor)}},"object"==typeof window&&(window.PolyBool=t),n.exports=t},{"./lib/build-log":2,"./lib/epsilon":3,"./lib/geojson":4,"./lib/intersecter":5,"./lib/segment-chainer":7,"./lib/segment-selector":8}],2:[function(e,n){n.exports=function(){var e,n=0,t=!1;function r(n,t){return e.list.push({type:n,data:t?JSON.parse(JSON.stringify(t)):void 0}),e}return e={list:[],segmentId:function(){return n++},checkIntersection:function(e,n){return r("check",{seg1:e,seg2:n})},segmentChop:function(e,n){return r("div_seg",{seg:e,pt:n}),r("chop",{seg:e,pt:n})},statusRemove:function(e){return r("pop_seg",{seg:e})},segmentUpdate:function(e){return r("seg_update",{seg:e})},segmentNew:function(e,n){return r("new_seg",{seg:e,primary:n})},segmentRemove:function(e){return r("rem_seg",{seg:e})},tempStatus:function(e,n,t){return r("temp_status",{seg:e,above:n,below:t})},rewind:function(e){return r("rewind",{seg:e})},status:function(e,n,t){return r("status",{seg:e,above:n,below:t})},vert:function(n){return n===t?e:(t=n,r("vert",{x:n}))},log:function(e){return"string"!=typeof e&&(e=JSON.stringify(e,!1,"  ")),r("log",{txt:e})},reset:function(){return r("reset")},selected:function(e){return r("selected",{segs:e})},chainStart:function(e){return r("chain_start",{seg:e})},chainRemoveHead:function(e,n){return r("chain_rem_head",{index:e,pt:n})},chainRemoveTail:function(e,n){return r("chain_rem_tail",{index:e,pt:n})},chainNew:function(e,n){return r("chain_new",{pt1:e,pt2:n})},chainMatch:function(e){return r("chain_match",{index:e})},chainClose:function(e){return r("chain_close",{index:e})},chainAddHead:function(e,n){return r("chain_add_head",{index:e,pt:n})},chainAddTail:function(e,n){return r("chain_add_tail",{index:e,pt:n})},chainConnect:function(e,n){return r("chain_con",{index1:e,index2:n})},chainReverse:function(e){return r("chain_rev",{index:e})},chainJoin:function(e,n){return r("chain_join",{index1:e,index2:n})},done:function(){return r("done")}}}},{}],3:[function(e,n){n.exports=function(e){"number"!=typeof e&&(e=1e-10);var n={epsilon:function(n){return"number"==typeof n&&(e=n),e},pointAboveOrOnLine:function(n,t,r){var o=t[0],i=t[1],l=r[0],s=r[1],a=n[0];return(l-o)*(n[1]-i)-(s-i)*(a-o)>=-e},pointBetween:function(n,t,r){var o=n[1]-t[1],i=r[0]-t[0],l=n[0]-t[0],s=r[1]-t[1],a=l*i+o*s;return!(a<e||a-(i*i+s*s)>-e)},pointsSameX:function(n,t){return Math.abs(n[0]-t[0])<e},pointsSameY:function(n,t){return Math.abs(n[1]-t[1])<e},pointsSame:function(e,t){return n.pointsSameX(e,t)&&n.pointsSameY(e,t)},pointsCompare:function(e,t){return n.pointsSameX(e,t)?n.pointsSameY(e,t)?0:e[1]<t[1]?-1:1:e[0]<t[0]?-1:1},pointsCollinear:function(n,t,r){var o=n[0]-t[0],i=n[1]-t[1],l=t[0]-r[0],s=t[1]-r[1];return Math.abs(o*s-l*i)<e},linesIntersect:function(n,t,r,o){var i=t[0]-n[0],l=t[1]-n[1],s=o[0]-r[0],a=o[1]-r[1],u=i*a-l*s;if(Math.abs(u)<e)return!1;var c=n[0]-r[0],f=n[1]-r[1],g=(s*f-a*c)/u,d=(i*f-l*c)/u,v={alongA:0,alongB:0,pt:[n[0]+g*i,n[1]+g*l]};return v.alongA=g<=-e?-2:g<e?-1:g-1<=-e?0:g-1<e?1:2,v.alongB=d<=-e?-2:d<e?-1:d-1<=-e?0:d-1<e?1:2,v},pointInsideRegion:function(n,t){for(var r=n[0],o=n[1],i=t[t.length-1][0],l=t[t.length-1][1],s=!1,a=0;a<t.length;a++){var u=t[a][0],c=t[a][1];c-o>e!=l-o>e&&(i-u)*(o-c)/(l-c)+u-r>e&&(s=!s),i=u,l=c}return s}};return n}},{}],4:[function(e,n){var t={toPolygon:function(e,n){function t(n){if(n.length<=0)return e.segments({inverted:!1,regions:[]});function t(n){var t=n.slice(0,n.length-1);return e.segments({inverted:!1,regions:[t]})}for(var r=t(n[0]),o=1;o<n.length;o++)r=e.selectDifference(e.combine(r,t(n[o])));return r}if("Polygon"===n.type)return e.polygon(t(n.coordinates));if("MultiPolygon"===n.type){for(var r=e.segments({inverted:!1,regions:[]}),o=0;o<n.coordinates.length;o++)r=e.selectUnion(e.combine(r,t(n.coordinates[o])));return e.polygon(r)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,n,t){function r(e,t){return n.pointInsideRegion([.5*(e[0][0]+e[1][0]),.5*(e[0][1]+e[1][1])],t)}function o(e){return{region:e,children:[]}}t=e.polygon(e.segments(t));var i=o(null);function l(e,n){for(var t=0;t<e.children.length;t++)if(r(n,(s=e.children[t]).region))return void l(s,n);var i=o(n);for(t=0;t<e.children.length;t++){var s;r((s=e.children[t]).region,n)&&(i.children.push(s),e.children.splice(t,1),t--)}e.children.push(i)}for(var s=0;s<t.regions.length;s++){var a=t.regions[s];a.length<3||l(i,a)}function u(e,n){for(var t=0,r=e[e.length-1][0],o=e[e.length-1][1],i=[],l=0;l<e.length;l++){var s=e[l][0],a=e[l][1];i.push([s,a]),t+=a*r-s*o,r=s,o=a}return t<0!==n&&i.reverse(),i.push([i[0][0],i[0][1]]),i}var c=[];function f(e){var n=[u(e.region,!1)];c.push(n);for(var t=0;t<e.children.length;t++)n.push(g(e.children[t]))}function g(e){for(var n=0;n<e.children.length;n++)f(e.children[n]);return u(e.region,!0)}for(s=0;s<i.children.length;s++)f(i.children[s]);return c.length<=0?{type:"Polygon",coordinates:[]}:1==c.length?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}};n.exports=t},{}],5:[function(e,n){var t=e("./linked-list");n.exports=function(e,n,r){function o(e,n,t){return{id:r?r.segmentId():-1,start:e,end:n,myFill:{above:t.myFill.above,below:t.myFill.below},otherFill:null}}var i=t.create();function l(e,t,r,o,i,l){var s=n.pointsCompare(t,i);return 0!==s?s:n.pointsSame(r,l)?0:e!==o?e?1:-1:n.pointAboveOrOnLine(r,o?i:l,o?l:i)?1:-1}function s(e,n){i.insertBefore(e,function(t){return l(e.isStart,e.pt,n,t.isStart,t.pt,t.other.pt)<0})}function a(e,n){var r=t.node({isStart:!0,pt:e.start,seg:e,primary:n,other:null,status:null});return s(r,e.end),r}function u(e,n,r){var o=t.node({isStart:!1,pt:n.end,seg:n,primary:r,other:e,status:null});e.other=o,s(o,e.pt)}function c(e,n){var t=a(e,n);return u(t,e,n),t}function f(e,n){r&&r.segmentChop(e.seg,n),e.other.remove(),e.seg.end=n,e.other.pt=n,s(e.other,e.pt)}function g(e,n){var t=o(n,e.seg.end,e.seg);return f(e,n),c(t,e.primary)}function d(o,l){var s=t.create();function a(e){return s.findTransition(function(t){var r,o,i,l,s,a;return r=e,o=t.ev,i=r.seg.start,l=r.seg.end,s=o.seg.start,a=o.seg.end,(n.pointsCollinear(i,s,a)?n.pointsCollinear(l,s,a)?1:n.pointAboveOrOnLine(l,s,a)?1:-1:n.pointAboveOrOnLine(i,s,a)?1:-1)>0})}function u(e,t){var o=e.seg,i=t.seg,l=o.start,s=o.end,a=i.start,u=i.end;r&&r.checkIntersection(o,i);var c=n.linesIntersect(l,s,a,u);if(!1===c){if(!n.pointsCollinear(l,s,a))return!1;if(n.pointsSame(l,u)||n.pointsSame(s,a))return!1;var f=n.pointsSame(l,a),d=n.pointsSame(s,u);if(f&&d)return t;var v=!f&&n.pointBetween(l,a,u),h=!d&&n.pointBetween(s,a,u);if(f)return h?g(t,s):g(e,u),t;v&&(d||(h?g(t,s):g(e,u)),g(t,l))}else 0===c.alongA&&(-1===c.alongB?g(e,a):0===c.alongB?g(e,c.pt):1===c.alongB&&g(e,u)),0===c.alongB&&(-1===c.alongA?g(t,l):0===c.alongA?g(t,c.pt):1===c.alongA&&g(t,s));return!1}for(var c=[];!i.isEmpty();){var f=i.getHead();if(r&&r.vert(f.pt[0]),f.isStart){r&&r.segmentNew(f.seg,f.primary);var d=a(f),v=d.before?d.before.ev:null,h=d.after?d.after.ev:null;function p(){if(v){var e=u(f,v);if(e)return e}return!!h&&u(f,h)}r&&r.tempStatus(f.seg,!!v&&v.seg,!!h&&h.seg);var m,b,y=p();if(y)e?(b=null===f.seg.myFill.below||f.seg.myFill.above!==f.seg.myFill.below)&&(y.seg.myFill.above=!y.seg.myFill.above):y.seg.otherFill=f.seg.myFill,r&&r.segmentUpdate(y.seg),f.other.remove(),f.remove();if(i.getHead()!==f){r&&r.rewind(f.seg);continue}e?(b=null===f.seg.myFill.below||f.seg.myFill.above!==f.seg.myFill.below,f.seg.myFill.below=h?h.seg.myFill.above:o,f.seg.myFill.above=b?!f.seg.myFill.below:f.seg.myFill.below):null===f.seg.otherFill&&(m=h?f.primary===h.primary?h.seg.otherFill.above:h.seg.myFill.above:f.primary?l:o,f.seg.otherFill={above:m,below:m}),r&&r.status(f.seg,!!v&&v.seg,!!h&&h.seg),f.other.status=d.insert(t.node({ev:f}))}else{var x=f.status;if(null===x)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(s.exists(x.prev)&&s.exists(x.next)&&u(x.prev.ev,x.next.ev),r&&r.statusRemove(x.ev.seg),x.remove(),!f.primary){var w=f.seg.myFill;f.seg.myFill=f.seg.otherFill,f.seg.otherFill=w}c.push(f.seg)}i.getHead().remove()}return r&&r.done(),c}return e?{addRegion:function(e){for(var t,o,i,l=e[e.length-1],s=0;s<e.length;s++){t=l,l=e[s];var a=n.pointsCompare(t,l);0!==a&&c((o=a<0?t:l,i=a<0?l:t,{id:r?r.segmentId():-1,start:o,end:i,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(e){return d(e,!1)}}:{calculate:function(e,n,t,r){return e.forEach(function(e){c(o(e.start,e.end,e),!0)}),t.forEach(function(e){c(o(e.start,e.end,e),!1)}),d(n,r)}}}},{"./linked-list":6}],6:[function(e,n){n.exports={create:function(){var e={root:{root:!0,next:null},exists:function(n){return null!==n&&n!==e.root},isEmpty:function(){return null===e.root.next},getHead:function(){return e.root.next},insertBefore:function(n,t){for(var r=e.root,o=e.root.next;null!==o;){if(t(o))return n.prev=o.prev,n.next=o,o.prev.next=n,void(o.prev=n);r=o,o=o.next}r.next=n,n.prev=r,n.next=null},findTransition:function(n){for(var t=e.root,r=e.root.next;null!==r&&!n(r);)t=r,r=r.next;return{before:t===e.root?null:t,after:r,insert:function(e){return e.prev=t,e.next=r,t.next=e,null!==r&&(r.prev=e),e}}}};return e},node:function(e){return e.prev=null,e.next=null,e.remove=function(){e.prev.next=e.next,e.next&&(e.next.prev=e.prev),e.prev=null,e.next=null},e}}},{}],7:[function(e,n){n.exports=function(e,n,t){var r=[],o=[];return e.forEach(function(e){var i=e.start,l=e.end;if(n.pointsSame(i,l))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{t&&t.chainStart(e);for(var s={index:0,matches_head:!1,matches_pt1:!1},a={index:0,matches_head:!1,matches_pt1:!1},u=s,c=0;c<r.length;c++){var f=(p=r[c])[0],g=(p[1],p[p.length-1]);if(p[p.length-2],n.pointsSame(f,i)){if(S(c,!0,!0))break}else if(n.pointsSame(f,l)){if(S(c,!0,!1))break}else if(n.pointsSame(g,i)){if(S(c,!1,!0))break}else if(n.pointsSame(g,l)&&S(c,!1,!1))break}if(u===s)return r.push([i,l]),void(t&&t.chainNew(i,l));if(u===a){t&&t.chainMatch(s.index);var d=s.index,v=s.matches_pt1?l:i,h=s.matches_head,p=r[d],m=h?p[0]:p[p.length-1],b=h?p[1]:p[p.length-2],y=h?p[p.length-1]:p[0],x=h?p[p.length-2]:p[1];return n.pointsCollinear(b,m,v)&&(h?(t&&t.chainRemoveHead(s.index,v),p.shift()):(t&&t.chainRemoveTail(s.index,v),p.pop()),m=b),n.pointsSame(y,v)?(r.splice(d,1),n.pointsCollinear(x,y,m)&&(h?(t&&t.chainRemoveTail(s.index,m),p.pop()):(t&&t.chainRemoveHead(s.index,m),p.shift())),t&&t.chainClose(s.index),void o.push(p)):void(h?(t&&t.chainAddHead(s.index,v),p.unshift(v)):(t&&t.chainAddTail(s.index,v),p.push(v)))}var w=s.index,F=a.index;t&&t.chainConnect(w,F);var _=r[w].length<r[F].length;s.matches_head?a.matches_head?_?(R(w),C(w,F)):(R(F),C(F,w)):C(F,w):a.matches_head?C(w,F):_?(R(w),C(F,w)):(R(F),C(w,F))}function S(e,n,t){return u.index=e,u.matches_head=n,u.matches_pt1=t,u===s?(u=a,!1):(u=null,!0)}function R(e){t&&t.chainReverse(e),r[e].reverse()}function C(e,o){var i=r[e],l=r[o],s=i[i.length-1],a=i[i.length-2],u=l[0],c=l[1];n.pointsCollinear(a,s,u)&&(t&&t.chainRemoveTail(e,s),i.pop(),s=a),n.pointsCollinear(s,u,c)&&(t&&t.chainRemoveHead(o,u),l.shift()),t&&t.chainJoin(e,o),r[e]=i.concat(l),r.splice(o,1)}}),o}},{}],8:[function(e,n){function t(e,n,t){var r=[];return e.forEach(function(e){var o=(e.myFill.above?8:0)+(e.myFill.below?4:0)+(e.otherFill&&e.otherFill.above?2:0)+(e.otherFill&&e.otherFill.below?1:0);0!==n[o]&&r.push({id:t?t.segmentId():-1,start:e.start,end:e.end,myFill:{above:1===n[o],below:2===n[o]},otherFill:null})}),t&&t.selected(r),r}var r={union:function(e,n){return t(e,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],n)},intersect:function(e,n){return t(e,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],n)},difference:function(e,n){return t(e,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],n)},differenceRev:function(e,n){return t(e,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],n)},xor:function(e,n){return t(e,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],n)}};n.exports=r},{}]},{},[1]);